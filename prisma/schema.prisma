generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = env("DATABASE_URL")
}

model Discipline {
  Discipline             String
  Discipline_Level1      String
  Discipline_Level2      String?
  DisciplineNumber       Int     @id
  DisciplineLevel        Int
  ParentDiscipline       String?
  ParentDisciplineNumber Float?
}

model Grant {
  GrantNumber                Int     @id @default(autoincrement())
  AmountGrantedAllSets       Float
  CallDecisionYear           Int
  CallEndDate                String?
  CallFullTitle              String?
  GrantEndDate               String
  GrantStartDate             String
  FundingInstrumentLevel1    String
  FundingInstrumentPublished String
  FundingInstrumentReporting String
  GrantNumberString          String
  Institute                  String?
  InstituteCountry           String?
  MainDisciplineNumber       Int
  ResearchInstitution        String?
  State                      String
  Title                      String
  TitleEnglish               String?

  GrantToPersonNetwork GrantToPersonNetwork[]

  OutputAward OutputAward[]
}

model GrantToDiscipline {
  DisciplineNumber Int
  GrantNumber      Int

  @@id([DisciplineNumber, GrantNumber])
}

model Institute {
  InstituteNumber     Int      @id @default(autoincrement())
  Institute           String
  InstituteCountry    String?
  ResearchInstitution String?
  Person              Person[]
}

model OutputAward {
  GrantNumber Int?
  OutputId    String  @id
  Title       String?
  Year        Int?

  grant Grant? @relation(fields: [GrantNumber], references: [GrantNumber])
}

model Person {
  PersonNumber          Int                    @id @default(autoincrement())
  InstituteNumber       Int?
  FirstName             String?
  Surname               String
  Gender                String
  InstitutePlace        String?
  ORCID                 String?
  GrantToPersonNetwork1 GrantToPersonNetwork[] @relation("Person1")
  GrantToPersonNetwork2 GrantToPersonNetwork[] @relation("Person2")

  institute Institute? @relation(fields: [InstituteNumber], references: [InstituteNumber])
}

model GrantToPersonNetwork {
  GrantNumber   Int
  PersonNumber1 Int
  PersonNumber2 Int
  Type          String

  Person1 Person @relation(fields: [PersonNumber1], references: [PersonNumber], name: "Person1")
  Person2 Person @relation(fields: [PersonNumber2], references: [PersonNumber], name: "Person2")
  Grant   Grant  @relation(fields: [GrantNumber], references: [GrantNumber])

  @@id([GrantNumber, PersonNumber1, PersonNumber2])
}
