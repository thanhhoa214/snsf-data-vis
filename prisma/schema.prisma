generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = env("DATABASE_URL")
}

model Discipline {
  Discipline             String  @id
  Discipline_Level1      String
  Discipline_Level2      String?
  DisciplineNumber       Int
  DisciplineLevel        Int
  ParentDiscipline       String?
  ParentDisciplineNumber Float?
}

model Grant {
  GrantNumber                Int     @id @default(autoincrement())
  AmountGrantedAllSets       Float
  CallDecisionYear           Int
  CallEndDate                String?
  CallFullTitle              String?
  GrantEndDate               String
  GrantStartDate             String
  FundingInstrumentLevel1    String
  FundingInstrumentPublished String
  FundingInstrumentReporting String
  GrantNumberString          String
  Institute                  String?
  InstituteCountry           String?
  MainDiscipline             String
  MainDisciplineNumber       Int
  ResearchInstitution        String?
  State                      String
  Title                      String
  TitleEnglish               String?

  GrantToPersonNetwork GrantToPersonNetwork[]
  GrantDateRange       GrantDateRange[]

  institute   Institute?    @relation(fields: [Institute], references: [Institute])
  OutputAward OutputAward[]
}

model GrantByPersonByDate {
  PersonNumber Int
  GrantNumber  Int

  @@id([PersonNumber, GrantNumber])
}

model GrantDateRange {
  GrantNumber    Int     @id @default(autoincrement())
  GrantStartDate String
  GrantEndDate   String
  YearlyAvg      Float
  DurationYears  Int
  DateList       String?

  grant Grant @relation(fields: [GrantNumber], references: [GrantNumber])
}

model GrantToDiscipline {
  DisciplineNumber Int
  GrantNumber      Int

  @@id([DisciplineNumber, GrantNumber])
}

model GrantToKeyword {
  GrantNumber Int
  KeywordId   Int

  @@id([GrantNumber, KeywordId])
}

model Institute {
  InstituteNumber     Int     @id @default(autoincrement())
  index               Int
  Institute           String  @unique
  InstituteCountry    String?
  ResearchInstitution String?

  grants Grant[]
}

model OutputAward {
  GrantNumber Int
  OutputId    String  @id
  Title       String?
  Year        Float?

  grant Grant @relation(fields: [GrantNumber], references: [GrantNumber])
}

model Person {
  PersonNumber          Int                    @id @default(autoincrement())
  InstituteNumber       Float?
  FirstName             String?
  Surname               String
  Gender                String
  Institute             String?
  InstitutePlace        String?
  ORCID                 String?
  GrantToPersonNetwork1 GrantToPersonNetwork[] @relation("Person1")
  GrantToPersonNetwork2 GrantToPersonNetwork[] @relation("Person2")
}

model GrantToPersonNetwork {
  GrantNumber   Int
  PersonNumber1 Int
  PersonNumber2 Int
  Type          String

  Person1 Person @relation(fields: [PersonNumber1], references: [PersonNumber], name: "Person1")
  Person2 Person @relation(fields: [PersonNumber2], references: [PersonNumber], name: "Person2")
  Grant   Grant  @relation(fields: [GrantNumber], references: [GrantNumber])

  @@id([GrantNumber, PersonNumber1, PersonNumber2])
}
